{% extends 'adminbase.html.twig' %}

{% block title %}Admin - Blog Management{% endblock %}

{% block body %}
<div class="page-header d-print-none">
  <div class="container-xl">
    <div class="row g-2 align-items-center">
      <div class="col">
        <h2 class="page-title">
          Blog Management
        </h2>
      </div>
    </div>
  </div>
</div>

<div class="page-body">
  <div class="container-xl">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">All Blog Posts</h3>
      </div>
      <div class="card-body">
        {% for message in app.flashes('success') %}
          <div class="alert alert-success alert-dismissible" role="alert">
            {{ message }}
            <a href="#" class="btn-close" data-bs-dismiss="alert" aria-label="close"></a>
          </div>
        {% endfor %}
        {% for message in app.flashes('error') %}
          <div class="alert alert-danger alert-dismissible" role="alert">
            {{ message }}
            <a href="#" class="btn-close" data-bs-dismiss="alert" aria-label="close"></a>
          </div>
        {% endfor %}
        
        <div class="table-responsive">
          <table class="table table-vcenter card-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Author</th>
                <th>Activity</th>
                <th>Date</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {% if posts|length > 0 %}
                {% for post in posts %}
                  <tr>
                    <td>{{ post.id }}</td>
                    <td>
                      <a href="{{ path('app_admin_blog_details', {'id': post.id}) }}">{{ post.title }}</a>
                    </td>
                    <td>{{ users[post.userId].name }} {{ users[post.userId].lastname }}</td>
                    <td>{{ activitiesById[post.activityId].activityName }}</td>
                    <td>{{ post.date|date('Y-m-d') }}</td>
                    <td>
                      <div class="btn-list flex-nowrap">
                        <a href="{{ path('app_admin_blog_details', {'id': post.id}) }}" class="btn btn-primary">
                          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-eye" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                            <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"></path>
                          </svg>
                          View
                        </a>
                        <a href="{{ path('app_admin_blog_delete', {'id': post.id}) }}" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this post?')">
                          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-trash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M4 7l16 0"></path>
                            <path d="M10 11l0 6"></path>
                            <path d="M14 11l0 6"></path>
                            <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"></path>
                            <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"></path>
                          </svg>
                          Delete
                        </a>
                      </div>
                    </td>
                  </tr>
                {% endfor %}
              {% else %}
                <tr>
                  <td colspan="6" class="text-center">No blog posts found</td>
                </tr>
              {% endif %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
