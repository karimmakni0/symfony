{% extends 'AdminBase.html.twig' %}

{% block title %}Manage Destinations{% endblock %}

{% block body %}
<div class="row y-gap-20 justify-between items-end pb-30">
    <div class="col-auto">
        <h1 class="text-30 lh-14 fw-600">Manage Destinations</h1>
        <div class="text-15 text-light-1">Manage all travel destinations in the system</div>
    </div>
</div>

<div class="py-30 px-30 rounded-4 bg-white shadow-3">
    <div class="tabs -underline-2 js-tabs">
        <div class="tabs__controls row x-gap-40 y-gap-10 lg:x-gap-20 js-tabs-controls">
            <div class="col-auto">
                <button class="tabs__button text-18 lg:text-16 text-light-1 fw-500 pb-5 lg:pb-0 js-tabs-button is-tab-el-active" data-tab-target=".-tab-item-1">All Destinations ({{ destinations|length }})</button>
            </div>
        </div>

        <div class="tabs__content pt-30 js-tabs-content">
            <div class="tabs__pane -tab-item-1 is-tab-el-active">
                <div class="overflow-scroll scroll-bar-1">
                    <table class="table-4 -border-bottom col-12">
                        <thead class="bg-light-2">
                            <tr>
                                <th>ID</th>
                                <th>Image</th>
                                <th>Name</th>
                                <th>Location</th>
                                <th>Created By</th>
                                <th>Description</th>
                                <th>Created At</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if destinations is empty %}
                                <tr>
                                    <td colspan="8" class="text-center">No destinations found</td>
                                </tr>
                            {% else %}
                                {% for destination in destinations %}
                                    <tr>
                                        <td>#{{ destination.id }}</td>
                                        <td>
                                            {% if destination.imagePath %}
                                                <img src="{{ asset(destination.imagePath) }}" alt="{{ destination.name }}" class="size-60 rounded-4 object-cover">
                                            {% else %}
                                                <div class="size-60 rounded-4 bg-light-2 flex-center text-14">No Image</div>
                                            {% endif %}
                                        </td>
                                        <td>{{ destination.name }}</td>
                                        <td>{{ destination.location }}</td>
                                        <td>
                                            {% if destination.user %}
                                                <div>
                                                    <div class="fw-500">{{ destination.user.name }}</div>
                                                    <div class="text-14 lh-15 text-light-1">{{ destination.user.email }}</div>
                                                </div>
                                            {% else %}
                                                <div class="text-14 text-light-1">Unknown User</div>
                                            {% endif %}
                                        </td>
                                        <td class="text-wrap">
                                            {{ destination.description|length > 50 ? destination.description|slice(0, 50) ~ '...' : destination.description }}
                                        </td>
                                        <td>{{ destination.createdAt|date('d/m/Y H:i') }}</td>
                                        <td>
                                            <div class="row x-gap-10 y-gap-10">
                                                <div class="col-auto">
                                                    <a href="{{ path('admin_delete_destination', {'id': destination.id}) }}" 
                                                       onclick="return confirm('Are you sure you want to delete the destination: {{ destination.name }}? This action cannot be undone.')" 
                                                       class="flex-center size-35 rounded-4 bg-red-3 text-white">
                                                        <i class="icon-trash text-12"></i>
                                                    </a>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Any additional JavaScript for destination management
    });
</script>
{% endblock %}
